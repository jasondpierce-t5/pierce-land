---
phase: 11-admin-config-form-ux
plan: 01
type: execute
depends_on: []
files_modified: [src/app/admin/config/page.tsx]
---

<objective>
Redesign the admin config form with collapsible accordion sections, section descriptions, and a sticky save bar for better navigation of 43 fields across 8 sections.

Purpose: The current form is a 529-line wall of inputs with no way to collapse sections or see the save button without scrolling to the bottom. This makes editing specific sections tedious.
Output: Collapsible accordion sections with descriptions, sticky action bar, improved visual hierarchy.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-shared-config-mgmt/03-01-SUMMARY.md

@src/app/admin/config/page.tsx
@src/app/admin/layout.tsx

**Tech stack available:** Next.js 14, Tailwind CSS, React useState/useEffect
**Established patterns:** controlled-forms, client-validation, fieldset/legend sections, brand colors (primary #1a3a2a, accent #c4872a)
**Constraining decisions:**
- [Phase 3]: Form organized into 8 sections with fieldset/legend pattern, 43 fields total
- [Phase 3]: Controlled inputs with useState for all fields, cancel resets to saved state
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor sections into collapsible accordion with descriptions</name>
  <files>src/app/admin/config/page.tsx</files>
  <action>
Replace flat fieldset/legend sections with a collapsible accordion pattern. Each section gets:

1. **Clickable section header** with chevron icon (rotates when open/closed). Use an inline SVG chevron — do NOT add any icon library. Header should show section name and a brief description.

2. **Section descriptions** (shown in the header area, visible even when collapsed):
   - Operator Information: "Business owner and operation details shown on plan cover"
   - Market Prices & Scenarios: "Current purchase and sale prices for scenario analysis"
   - Feed Costs: "Hay and daily feed expenses used in cost projections"
   - Operational Parameters: "Animal weights, daily gain, and mortality assumptions"
   - Spring Turn Costs: "Per-head costs for the spring grazing season"
   - Winter Turn Costs: "Per-head costs for the winter feeding season"
   - Winter Feed Details: "Hay and commodity pricing for winter feed calculations"
   - Financial Defaults: "Interest rate, line of credit, and herd size defaults"

3. **Accordion state:** Use a `useState<Set<number>>` to track which sections are open. Default all sections to collapsed EXCEPT the first one (Operator Information). Clicking a header toggles that section. Multiple sections can be open simultaneously (not mutually exclusive).

4. **Section styling:** Each section should be a card-like container with:
   - `bg-white rounded-lg border border-gray-200 shadow-sm` for the card
   - Header: `px-6 py-4 cursor-pointer flex items-center justify-between` with hover state
   - Section name: `text-lg font-semibold text-gray-900`
   - Description: `text-sm text-gray-500 mt-0.5`
   - Chevron: 20x20 SVG, `text-gray-400`, rotates 180deg when section is open (use `transition-transform duration-200`)
   - Content area: `px-6 pb-6` (hidden when collapsed, shown when open)
   - Keep the existing 2-column grid layout for fields inside each section

5. **Wrap the sections** in a `space-y-4` container instead of directly in the form. Move the form wrapper out — the form should wrap all sections including the action bar.

Do NOT change the form submission logic, validation, handleChange, or any field definitions. Only restructure the visual layout.
  </action>
  <verify>npm run build passes without errors. Dev server shows config page with 8 collapsible sections. Clicking section headers toggles open/closed with chevron animation. Section descriptions visible in headers.</verify>
  <done>8 sections render as collapsible cards with descriptions. Multiple can be open. First section open by default. Chevron rotates on toggle. All 43 fields still present and functional.</done>
</task>

<task type="auto">
  <name>Task 2: Add sticky save/cancel action bar</name>
  <files>src/app/admin/config/page.tsx</files>
  <action>
Replace the current bottom-of-form action buttons with a sticky action bar:

1. **Sticky bar** at the bottom of the viewport:
   - `fixed bottom-0 left-0 right-0` (or `sticky bottom-0`)
   - `bg-white border-t border-gray-200 shadow-lg` for visual separation
   - `px-6 py-3` padding, content centered with `max-w-4xl mx-auto`
   - `z-10` to stay above content

2. **Bar contents** (same buttons, better layout):
   - Left side: Success/error message (move from top of form to inside the bar — more visible near actions)
   - Right side: Cancel and Save buttons (keep existing styles and behavior)
   - Use `flex items-center justify-between`

3. **Add bottom padding to the form container** (`pb-20` or similar) so content doesn't get hidden behind the sticky bar.

4. **Keep the existing message banner at the top of the page as well** for initial load errors (like "Failed to load configuration"). The sticky bar message is specifically for save success/error feedback — a transient notification near the action that triggered it.

Do NOT change button behavior, submit logic, or validation. Only move the action bar to be sticky and relocate save feedback to it.
  </action>
  <verify>npm run build passes. Dev server shows sticky action bar at bottom of viewport. Scrolling through sections keeps save/cancel visible. Saving shows success message in the bar. Cancel resets form.</verify>
  <done>Action bar sticks to bottom of viewport. Save/cancel always visible regardless of scroll position. Success/error messages appear in the bar. Bottom padding prevents content overlap.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Collapsible accordion sections with descriptions and sticky save bar for the admin config form</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/admin/config (log in if needed)
    3. Verify 8 collapsible sections with descriptions in headers
    4. Click section headers — verify toggle open/close with chevron animation
    5. Confirm multiple sections can be open simultaneously
    6. Scroll down — verify save/cancel bar stays visible at bottom
    7. Change a value and save — verify success message appears in sticky bar
    8. Confirm all 43 fields are present and editable
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] All 8 sections collapsible with descriptions
- [ ] Sticky action bar visible at all scroll positions
- [ ] All 43 fields present and functional
- [ ] Form submission still works (save and cancel)
- [ ] No TypeScript errors
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Config form has professional accordion layout with sticky save bar
</success_criteria>

<output>
After completion, create `.planning/phases/11-admin-config-form-ux/11-01-SUMMARY.md`
</output>
