---
phase: 06-public-plan-pages
plan: 03
type: execute
---

<objective>
Complete the business plan page with scenario analysis, breakeven, worst-case, sensitivity analysis, and disclaimer sections. Verify the full plan page renders correctly with human review.

Purpose: Deliver the analytical sections that demonstrate financial rigor and risk awareness to bankers — the sections that differentiate a professional plan from a basic spreadsheet.
Output: Complete /plan/[slug] page with all business plan sections, verified by human review.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/phase-prompt.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-public-plan-pages/06-01-SUMMARY.md
@.planning/phases/06-public-plan-pages/06-02-SUMMARY.md
@src/app/plan/[slug]/page.tsx
@src/lib/types.ts
@src/lib/calculations.ts
@src/lib/formatters.ts
@src/lib/plan-data.ts

**Established patterns:** Section heading with accent border-l-4 pl-4 text-2xl font-bold, white card shadow-sm rounded-lg p-6, TableRow/SubtotalRow/TotalRow helpers, formatCurrency/formatPercent/formatCwt from formatters.ts, green text for positive values / red for negative

**Constraining decisions:**
- Sensitivity defaults: hay $40-$80/bale step $10, purchase +/-$0.20/lb step $0.10 — from 05-03
- Worst-case uses +$0.20/lb premium on purchase + lowest sale price — from 05-03
- No rounding at calculation level — formatters handle display (from 05-02)
- ScenarioAnalysis has .low/.mid/.high each with salePriceCwt, springNet, winterNet, annualNet
- HaySensitivityTable is array of points, PurchaseSensitivityTable is array of points
- WorstCaseScenario has purchasePriceCwt, salePriceCwt, springNet, winterNet, annualNet, description
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Scenario Analysis, Breakeven, and Worst-Case sections</name>
  <files>src/app/plan/[slug]/page.tsx</files>
  <action>
Add three analysis sections after Credit Structure.

**Scenario Analysis section:**
- Section heading: "Scenario Analysis" with accent border-l-4
- White card with comparison table
- Table structure: 4 columns (Metric | Low | Mid | High)
- Header row: bg-gray-50, columns labeled "Low", "Mid", "High" with color tints (red-50, gray-50, green-50)
- Data rows:
  - "Sale Price" → .salePriceCwt formatCwt for each scenario
  - "Spring Net/Head" → .springNet formatCurrency
  - "Winter Net/Head" → .winterNet formatCurrency
  - "Annual Net Income" → .annualNet formatCurrencyWhole — bold bottom row
- Color coding: Low column values in text-red-600, Mid in text-gray-900, High in text-green-600
- Footer note: "Annual figures based on {config.head_count} head" text-sm text-gray-500

**Breakeven Analysis section:**
- Section heading: "Breakeven Analysis" with accent border-l-4
- Two cards side-by-side (grid md:grid-cols-2 gap-4):
  - Spring Breakeven card: bg-white shadow-sm rounded-lg p-6 text-center
    - Label: "Spring Turn Breakeven" text-sm text-gray-500
    - Value: breakeven.springBreakeven formatCwt — text-2xl font-bold
  - Winter Breakeven card: same layout
    - Label: "Winter Turn Breakeven"
    - Value: breakeven.winterBreakeven formatCwt — text-2xl font-bold
- Below cards: "Minimum sale price per cwt required to cover all costs" text-sm text-gray-500 italic

**Worst-Case Scenario section:**
- Section heading: "Worst-Case Scenario" with accent border-l-4
- Warning-styled card: bg-amber-50 border border-amber-200 rounded-lg p-6
- Description text at top: worstCase.description in text-gray-700
- Details grid (grid md:grid-cols-2 gap-x-8 gap-y-2 mt-4):
  - Purchase Price: worstCase.purchasePriceCwt formatCwt
  - Sale Price: worstCase.salePriceCwt formatCwt
  - Spring Net/Head: worstCase.springNet formatCurrency (red if negative)
  - Winter Net/Head: worstCase.winterNet formatCurrency (red if negative)
- Bottom emphasis row (mt-4 pt-4 border-t border-amber-200):
  - "Annual Net Impact: {worstCase.annualNet formatCurrencyWhole}" — text-xl font-bold, red if negative
  </action>
  <verify>npm run build passes. Scenario table shows three columns with color coding. Breakeven cards display minimum prices. Worst-case shows risk analysis in amber card.</verify>
  <done>Scenario Analysis comparison table, Breakeven cards, and Worst-Case warning card render with properly formatted and color-coded calculated data</done>
</task>

<task type="auto">
  <name>Task 2: Add Sensitivity Analysis tables and Disclaimer footer</name>
  <files>src/app/plan/[slug]/page.tsx</files>
  <action>
Add Sensitivity Analysis and Disclaimer sections to complete the business plan page.

**Hay Price Sensitivity section:**
- Section heading: "Hay Price Sensitivity" with accent border-l-4
- White card with data table
- Table columns: Hay Price/Bale | Hay Cost/Head | Total Feed Cost | Winter Net/Head | Annual Net
- One row per data point from haySensitivity array
- Each HaySensitivityPoint should have fields like: hayPricePerBale (or similar), hayCostPerHead, totalFeedCost, winterNetPerHead, annualNet — check actual type definition in types.ts and use correct field names
- Highlight the row matching (or closest to) current config hay_price_per_bale: apply bg-accent/10 border-l-2 border-accent to that row
- Format values: hay price formatCurrency, costs formatCurrency, net income formatCurrency (green/red), annual formatCurrencyWhole (green/red)
- Table styling: text-sm for compact display, striped rows (even:bg-gray-50), header bg-gray-100

**Purchase Price Sensitivity section:**
- Section heading: "Purchase Price Sensitivity" with accent border-l-4
- White card with data table
- Table columns: Purchase Price/CWT | Spring Net/Head | Winter Net/Head | Annual Net
- One row per data point from purchaseSensitivity array — check actual field names in types.ts
- Highlight row matching current config market_price_500lb (or closest)
- Same formatting and styling as hay sensitivity table

**Disclaimer footer (bottom of entire page):**
- mt-12 to separate from last section
- bg-gray-50 rounded-lg p-6 text-center
- Text in text-sm text-gray-400:
  "This business plan contains forward-looking financial projections based on current market conditions and operational assumptions. Actual results may vary based on market fluctuations, weather conditions, animal health, and other factors beyond the operator's control. All figures are estimates and should not be construed as guarantees of future performance."
- Below, smaller: "Generated by Pierce Land & Cattle Business Plan System" text-xs text-gray-300

Ensure the full page reads as a cohesive, professional document from cover header through disclaimer.
  </action>
  <verify>npm run build passes. Sensitivity tables render all data points with highlighted current config row. Disclaimer appears at page bottom.</verify>
  <done>Hay and purchase price sensitivity tables render with all data points, current config rows highlighted with accent color. Disclaimer footer completes the professional business plan page.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete public business plan page at /plan/[slug] with all sections: cover header, KPI summary row, operation overview, spring turn table, winter turn table, annual projections, credit structure with utilization bar, scenario analysis, breakeven analysis, worst-case scenario, hay price sensitivity, purchase price sensitivity, and disclaimer</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/plan/[slug] (use a slug from your bank versions, e.g., /plan/cameron or whichever exists)
    3. Verify cover header shows correct bank name, "Pierce Land & Cattle", operator info, current date
    4. Check KPI row shows 5 metrics with properly formatted values
    5. Scroll through Operation Overview — operator details and operation parameters should be accurate
    6. Check Spring Turn table has full cost breakdown with purchase, carrying costs, revenue, net income
    7. Check Winter Turn table includes feed cost breakdown (hay, commodity) in addition to standard costs
    8. Verify Annual Projections shows aggregated totals matching head count
    9. Check Credit Structure has LOC utilization bar with appropriate color
    10. Verify Scenario Analysis table has Low/Mid/High columns with red/green color coding
    11. Check Breakeven cards show reasonable breakeven prices
    12. Verify Worst-Case section is in amber warning card
    13. Check both Sensitivity tables highlight the current config row
    14. Confirm Disclaimer appears at bottom
    15. Overall: Does this look professional enough to present to a banker?
    16. Visit: http://localhost:3000/plan/nonexistent — should show 404
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] All 12+ sections render on /plan/[slug] with real data
- [ ] All numbers properly formatted (currency, percentages, weights, cwt)
- [ ] Scenario colors: red for low/losses, green for high/profits
- [ ] Sensitivity tables highlight current config value rows
- [ ] Worst-case displayed in amber warning card
- [ ] Page looks professional and cohesive top-to-bottom
- [ ] 404 works for invalid/inactive slugs
- [ ] No TypeScript errors
- [ ] Human verification approved
</verification>

<success_criteria>
- All tasks completed and human verification approved
- Complete business plan page renders all financial and analytical sections
- Professional appearance suitable for banker presentation
- Phase 6 complete, ready for Phase 7 (Charts & Visualizations)
</success_criteria>

<output>
After completion, create `.planning/phases/06-public-plan-pages/06-03-SUMMARY.md`
</output>
