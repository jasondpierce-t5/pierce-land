---
phase: 08-print-deployment
plan: 01
type: execute
depends_on: []
files_modified: [src/app/globals.css, src/app/plan/[slug]/page.tsx]
---

<objective>
Add comprehensive print styles and a print trigger so bank business plans produce clean, professional PDFs via browser print-to-PDF.

Purpose: These plans go directly to ag lending officers ‚Äî print quality directly impacts lending decisions. Every section must page-break cleanly, charts must render in color, and the output must look intentionally designed for print.
Output: Print-optimized globals.css, print button component on plan page, verified PDF output.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-charts-visualizations/07-02-SUMMARY.md

# Key files:
@src/app/globals.css
@src/app/plan/[slug]/page.tsx
@tailwind.config.ts

**Tech stack available:** Next.js 14, Tailwind CSS v3, Chart.js 4, react-chartjs-2 v5
**Established patterns:** Tailwind utility classes, card wrappers with bg-white shadow-sm rounded-lg p-6, chart wrapper pattern
**Constraining decisions:**
- [PROJECT.md]: Browser print-to-PDF is sufficient for v1 (no server-side PDF generation)
- [06-02]: Inline helper components within page.tsx (TableRow, SubtotalRow, etc.)
- [07-02]: Charts placed below data sections with mt-6 spacing and matching card styling
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add comprehensive print stylesheet</name>
  <files>src/app/globals.css</files>
  <action>
Add @media print rules to globals.css after the Tailwind directives. The print stylesheet must handle:

**Page setup:**
- @page { margin: 0.75in 0.5in; size: letter; }
- Force background colors: print-color-adjust: exact; -webkit-print-color-adjust: exact; on body

**Element visibility:**
- Hide elements with a `.no-print` utility class (display: none !important)
- This class will be used on the print button in Task 2

**Page breaks:**
- page-break-before: always on elements with `.print-break-before` class (for major sections)
- page-break-inside: avoid on elements with `.print-no-break` class (for tables, cards, chart wrappers)
- Orphan/widow control: orphans: 3; widows: 3 on body

**Visual cleanup for print:**
- Remove box-shadow on all elements (box-shadow: none !important)
- Remove border-radius if desired (keep it ‚Äî print handles rounded corners fine)
- Ensure all text is black/dark for readability: body color #1a1a1a
- Links: no underline decoration change needed (already styled)

**Chart handling:**
- canvas elements: max-width: 100%; height: auto !important to fit print width
- Chart wrapper divs: page-break-inside: avoid

**Typography:**
- Base font size: 11pt for print (readable but space-efficient)
- h1: 18pt, h2: 15pt, h3: 13pt, h4: 12pt
- Line height: 1.4 for print density

Do NOT touch any existing styles. Only add a clearly-commented @media print block and the utility classes.
  </action>
  <verify>npm run build passes without errors. Inspect globals.css to confirm @media print block is present.</verify>
  <done>globals.css contains comprehensive @media print rules covering page setup, visibility, breaks, visual cleanup, chart handling, and typography</done>
</task>

<task type="auto">
  <name>Task 2: Add print button and apply print classes to plan page</name>
  <files>src/app/plan/[slug]/page.tsx</files>
  <action>
Two changes to the plan page:

**1. Print button component:**
Create a small client component inline or as a separate file (prefer inline "use client" wrapper since it's tiny):
- A "Print / Save as PDF" button positioned in the top-right area of the page (fixed or sticky)
- Styled with brand colors: bg-primary text-white px-4 py-2 rounded-lg shadow-md
- onClick calls window.print()
- Add `no-print` class so it's hidden in print output
- Add a printer icon (use a simple SVG inline or Unicode character like üñ®Ô∏è ‚Äî actually avoid emoji, use text "Print Plan" or an inline SVG)

**2. Apply print utility classes to plan page sections:**
- Add `print-break-before` class to these major section containers in page.tsx:
  - "Operation Overview" section
  - "Spring Turn" section
  - "Annual Projections" section
  - "Credit Structure" section
  - "Scenario Analysis" section
  - "Breakeven Analysis" section
  - "Hay Price Sensitivity" section
- Add `print-no-break` class to:
  - All table elements or table wrapper divs
  - All chart wrapper divs (the bg-white shadow-sm rounded-lg p-6 containers around charts)
  - KPI summary row
  - Breakeven analysis cards
  - Worst-case scenario card

The print-break-before placement should create natural page boundaries at approximately:
- Page 1: Cover header + KPI row + Operation Overview
- Page 2: Spring Turn table + Spring Cost Chart
- Page 3: Winter Turn table + Winter Cost Chart
- Page 4: Annual Projections + Credit Structure
- Page 5: Scenario Analysis table + chart
- Page 6: Breakeven + Worst-Case
- Page 7: Sensitivity tables + charts + Disclaimer

Do NOT restructure the page component or change any existing styling. Only ADD classes to existing elements.
  </action>
  <verify>npm run build passes. Search page.tsx for "print-break-before" and "print-no-break" to confirm classes applied. Search for "Print Plan" or "window.print" to confirm button exists.</verify>
  <done>Print button renders on plan page (hidden in print), print utility classes applied to all major sections and unbreakable elements</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Print-optimized business plan page with print button</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/plan/[any-existing-slug]
    3. Click the "Print Plan" button (should open browser print dialog)
    4. In print preview, verify:
       a. Cover header appears on first page with colors intact
       b. No content is cut mid-table or mid-chart
       c. Charts render in color (not grayscale)
       d. Page breaks occur at logical section boundaries
       e. Print button itself is NOT visible in print preview
       f. Text is readable at print size
       g. No unnecessary whitespace or empty pages
    5. Optional: Actually save as PDF and open to verify quality
    6. Confirm: Professional enough to hand to a banker
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] globals.css contains @media print rules
- [ ] Plan page has print button (hidden in print)
- [ ] Print utility classes applied to page sections
- [ ] Human verified print output quality
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Print preview shows professional, page-break-aware output
- Charts render in color in print
- No content cut mid-element
- Print button hidden in print output
  </success_criteria>

<output>
After completion, create `.planning/phases/08-print-deployment/08-01-SUMMARY.md`
</output>
