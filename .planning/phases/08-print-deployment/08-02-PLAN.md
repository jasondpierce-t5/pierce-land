---
phase: 08-print-deployment
plan: 02
type: execute
depends_on: ["08-01"]
files_modified: [next.config.js]
---

<objective>
Deploy the complete Pierce Land & Cattle application to Vercel and configure the custom domain piercelandandcattle.com.

Purpose: Make the app publicly accessible at the production domain so bank-specific plan URLs work for real lenders.
Output: Live production deployment at piercelandandcattle.com with all features working.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-print-deployment/08-01-SUMMARY.md

# Key files:
@next.config.js
@.env.local
@middleware.ts
@package.json

**Tech stack available:** Next.js 14, Vercel, Supabase
**Constraining decisions:**
- [PROJECT.md]: Must deploy to piercelandandcattle.com
- [01-02]: Simple Supabase client pattern (not SSR patterns)
- [02-01]: httpOnly cookies for auth sessions — must work with Vercel deployment
</context>

<tasks>

<task type="auto">
  <name>Task 1: Production build verification</name>
  <files>next.config.js</files>
  <action>
Verify the app builds cleanly for production:

1. Run `npm run build` and confirm it succeeds with zero errors
2. If build fails, fix any issues

3. Review next.config.js — current config is empty `{}`. Add only if needed:
   - If there are any image domains to configure, add them
   - If any headers are needed (unlikely for v1), add them
   - Do NOT add unnecessary configuration

4. Run `npm run build` again if config was changed to confirm clean build

5. Verify .env.local has the required Supabase variables (NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY). Do NOT display or log the values. Just confirm the keys exist.

Do NOT modify any application code. This is verification only (plus minimal config if needed).
  </action>
  <verify>npm run build exits with code 0, no TypeScript errors, no warnings</verify>
  <done>Production build succeeds cleanly. next.config.js is production-ready. Environment variable keys confirmed present.</done>
</task>

<task type="auto">
  <name>Task 2: Deploy to Vercel</name>
  <files></files>
  <action>
Deploy the application to Vercel using the CLI:

1. Check if Vercel CLI is installed: `npx vercel --version`
   - If not installed, install it: `npm i -g vercel`

2. Deploy: `npx vercel --yes`
   - This creates the project on Vercel if it doesn't exist
   - If authentication is required (auth gate), stop and request human auth

3. After initial deploy succeeds, set production environment variables:
   - `npx vercel env add NEXT_PUBLIC_SUPABASE_URL production` (read value from .env.local)
   - `npx vercel env add NEXT_PUBLIC_SUPABASE_ANON_KEY production` (read value from .env.local)
   - If there's an ADMIN_PASSWORD or similar secret, add it too

4. Deploy to production: `npx vercel --prod`

5. Capture the production URL from the output

If Vercel CLI requires authentication at any step, stop and create a dynamic checkpoint requesting the user to run `npx vercel login` in their terminal.
  </action>
  <verify>npx vercel ls shows the deployment. curl the production URL returns 200 status.</verify>
  <done>App deployed to Vercel production. Environment variables set. Production URL accessible and returning 200.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Production deployment on Vercel — custom domain configuration needed</what-built>
  <how-to-verify>
    1. Visit the Vercel production URL (provided by Task 2 output)
    2. Confirm: Homepage loads without errors
    3. Confirm: /plan/[slug] pages render correctly with charts
    4. Confirm: Print button works on plan pages
    5. Confirm: Admin login works at /admin/login

    **Custom domain setup (requires your action):**
    6. Go to Vercel Dashboard → Project → Settings → Domains
    7. Add domain: piercelandandcattle.com
    8. Vercel will show DNS records to configure
    9. At your domain registrar, update DNS:
       - A record: 76.76.21.21 (Vercel's IP)
       - OR CNAME: cname.vercel-dns.com (if using subdomain)
    10. Wait for DNS propagation (usually 5-30 minutes)
    11. Verify: https://piercelandandcattle.com loads the app
    12. Verify: SSL certificate is active (padlock icon)
  </how-to-verify>
  <resume-signal>Type "approved" when domain is configured and site loads at piercelandandcattle.com, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds
- [ ] App deployed to Vercel production
- [ ] Environment variables configured on Vercel
- [ ] Production URL returns working app
- [ ] Custom domain configured (piercelandandcattle.com)
- [ ] SSL active on custom domain
- [ ] Plan pages render correctly in production
- [ ] Print-to-PDF works in production
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- piercelandandcattle.com serves the application
- /plan/[slug] routes work with real data
- Print-to-PDF produces professional output
- Phase 8 complete — project fully deployed
  </success_criteria>

<output>
After completion, create `.planning/phases/08-print-deployment/08-02-SUMMARY.md`

This is the FINAL phase. When complete:
- Update STATE.md: Phase 8/8 complete, project deployed
- Update ROADMAP.md: Phase 8 marked complete
</output>
